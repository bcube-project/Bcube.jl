<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Integration · Bcube</title><meta name="title" content="Integration · Bcube"/><meta property="og:title" content="Integration · Bcube"/><meta property="twitter:title" content="Integration · Bcube"/><meta name="description" content="Documentation for Bcube."/><meta property="og:description" content="Documentation for Bcube."/><meta property="twitter:description" content="Documentation for Bcube."/><meta property="og:url" content="https://bcube-project.github.io/Bcube.jl/manual/integration/"/><meta property="twitter:url" content="https://bcube-project.github.io/Bcube.jl/manual/integration/"/><link rel="canonical" href="https://bcube-project.github.io/Bcube.jl/manual/integration/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.jpg" alt="Bcube logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Bcube</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../conventions/">Conventions</a></li><li><a class="tocitem" href="../geometry/">Geometry and mesh</a></li><li class="is-active"><a class="tocitem" href>Integration</a><ul class="internal"><li><a class="tocitem" href="#Defining-a-(bi)linear-form"><span>Defining a (bi)linear form</span></a></li><li><a class="tocitem" href="#Computing-a-raw-integral"><span>Computing a raw integral</span></a></li></ul></li><li><a class="tocitem" href="../function_space/">Function and FE spaces</a></li><li><a class="tocitem" href="../cellfunction/">Cell function</a></li><li><a class="tocitem" href="../assembler/">Assemble (bi)linear forms</a></li><li><a class="tocitem" href="../operator/">LazyOperators</a></li></ul></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../../api/mesh/mesh/">Mesh</a></li><li><a class="tocitem" href="../../api/mesh/gmsh_utils/">GMSH</a></li><li><a class="tocitem" href="../../api/mesh/mesh_generator/">Mesh generator</a></li><li><a class="tocitem" href="../../api/interpolation/shape/">Reference shape</a></li><li><a class="tocitem" href="../../api/interpolation/function_space/">Function spaces</a></li><li><a class="tocitem" href="../../api/interpolation/fespace/">Finite element spaces</a></li><li><a class="tocitem" href="../../api/mapping/mapping/">Mapping</a></li><li><a class="tocitem" href="../../api/integration/integration/">Integration</a></li><li><a class="tocitem" href="../../api/dof/dof/">Degree of freedom</a></li><li><a class="tocitem" href="../../api/io/io_interface/">IO interface</a></li></ul></li><li><a class="tocitem" href="../../howto/howto/">How to... (FAQ)</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Integration</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Integration</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/bcube-project/Bcube.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/bcube-project/Bcube.jl/blob/main/docs/src/manual/integration.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Integration"><a class="docs-heading-anchor" href="#Integration">Integration</a><a id="Integration-1"></a><a class="docs-heading-anchor-permalink" href="#Integration" title="Permalink"></a></h1><p>To compute an integral on a geometrical element, for instance a curved element, a variable substitution is used to compute the integral on the corresponding reference <code>Shape</code>. This variable substitution reads:</p><p class="math-container">\[\int_\Omega g(x) \mathrm{\,d} \Omega = \int_{\hat{\Omega}} |J(x)| \left(g \circ F \right)(\hat{x}) \mathrm{\,d} \hat{\Omega},\]</p><p>where we recall that <span>$F$</span> is the reference to physical mapping and <span>$J$</span> is the determinant of the jacobian matrix of this mapping. Depending on the shape and element order, this determinant is either hard-coded or computed with <code>ForwardDiff</code>.</p><p>Now, to compute the right side, i.e the integral on the reference shape, quadrature rules are applied to <span>$\hat{g} = g \circ F$</span>:</p><p class="math-container">\[\int_{\hat{\Omega}} \hat{g}(\hat{x}) \mathrm{\,d} \hat{\Omega} = \sum_{i =1}^{N_q} \omega_i \hat{g}(\hat{x}_i)\]</p><p>A specific procedure is applied to compute integrals on a face of a cell (i.e a surfacic integral on a face of a volumic element).</p><h2 id="Defining-a-(bi)linear-form"><a class="docs-heading-anchor" href="#Defining-a-(bi)linear-form">Defining a (bi)linear form</a><a id="Defining-a-(bi)linear-form-1"></a><a class="docs-heading-anchor-permalink" href="#Defining-a-(bi)linear-form" title="Permalink"></a></h2><p>When using the FEM or the DG method, (bi)linear forms have to be defined. These forms represent scalar products between functions, and involve an integration. For instance, the common bilinear form (corresponding to the mass matrix once assembled) is <span>$(u,v) \mapsto \int u\cdot v \, \mathrm{d}\Omega$</span>. In Bcube, this integral translates to:</p><pre><code class="language-julia hljs">mesh = (...)
Ω = CellDomain(mesh)
dΩ = Measure(Ω, 2)
a(u,v) = ∫(u⋅v)dΩ</code></pre><p>You can see a new concept here : the <code>Measure</code> <code>dΩ</code>. A measure is built from a domain (cell of face) and a quadrature rule. Several quadrature rules are available, see <a href="../../api/integration/integration/#quadratures">here</a>.</p><div class="admonition is-info" id="Info-2c64428f2dfc5236"><header class="admonition-header">Info<a class="admonition-anchor" href="#Info-2c64428f2dfc5236" title="Permalink"></a></header><div class="admonition-body"><p>We&#39;ve done nothing else that defining a function <code>a</code> above. It is then intended to be used with the <code>assemble_bilinear</code> function (and FESpaces).</p></div></div><h2 id="Computing-a-raw-integral"><a class="docs-heading-anchor" href="#Computing-a-raw-integral">Computing a raw integral</a><a id="Computing-a-raw-integral-1"></a><a class="docs-heading-anchor-permalink" href="#Computing-a-raw-integral" title="Permalink"></a></h2><p>It is possible to compute an integral over a domain directly without assembling a (bi)linear form, for instance to compute the area of the cells, or the error between an analytical and a numerical solution. To do so, use the <code>Bcube.compute</code> function:</p><pre><code class="language-julia hljs">g = PhysicalFunction(x -&gt; 2 * x[1])
result = Bcube.compute(∫(g)dΩ)</code></pre><p>The obtained <code>result</code> is actually not the sum over the elements of <code>Ω</code>, but a <code>SparseVector</code> with the result of the integration element-wise. So if you integrate over a subset of the mesh cells, the result will be a sparse vector containing only non-zero values for those cells.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../geometry/">« Geometry and mesh</a><a class="docs-footer-nextpage" href="../function_space/">Function and FE spaces »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Thursday 6 November 2025 16:11">Thursday 6 November 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
